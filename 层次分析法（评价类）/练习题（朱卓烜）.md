# 一、应用层次分析法解决

## （1）大学毕业生就业选择问题

![1655214024849](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655214024849.png)

**做题过程：**

![1655253670527](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655253670527.png)



```matlab
  A=[1 1/3 1/2 1/3 1/2 1;
    3 1 2 1 2 2;
    2 1/2 1 1/2 1 1/2;
    3 1 2 1 2 2;
    2 1/2 1 1/2 1 1;
    1 1/2 2 1/2 1 1]; %评价矩阵
[n,n]=size(A);
[v,d]=eig(A);
r=d(1,1); 
CI=(r-n)/(n-1);
RI=[0 0 0.58 0.9 1.12 1.24 1.32 1.41 1.45 1.49 1.52 1.54 1.56 1.58 1.59];
CR=CI/RI(n); 
if CR<0.1 CR_Result='yes';
else CR_Result='no';
end
w=v(:,1)/sum(v(:,1));
w=w';
disp('the result is')
disp(['coincidence indicator:',num2str(CI)])%一致性指标
disp(['consistency ratio:',num2str(CR)])%一致性比例
disp(['Consistency test results:',CR_Result])%一致性检验
disp(['eigenvalue:',num2str(r)])%特征值
disp(['weight vector:',num2str(w)])%权向量

```

![1655251665725](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655251665725.png)

```matlab
A=[1 1/3 1/2 1/3 1/2 1;
    3 1 2 1 2 2;
    2 1/2 1 1/2 1 1/2;
    3 1 2 1 2 2;
    2 1/2 1 1/2 1 1;
    1 1/2 2 1/2 1 1]; %评价矩阵                      
                                   %因素对比矩阵A，只需要改变矩阵A
[m,n]=size(A);                     %获取指标个数
RI=[0 0 0.58 0.90 1.12 1.24 1.32 1.41 1.45 1.49 1.51];
R=rank(A);                         %求判断矩阵的秩
[V,D]=eig(A);                      %求判断矩阵的特征值和特征向量，V特征值，D特征向量；
tz=max(D);
B=max(tz);                         %最大特征值
[row, col]=find(D==B);             %最大特征值所在位置
C=V(:,col);                        %对应特征向量
CI=(B-n)/(n-1);                    %计算一致性检验指标CI
CR=CI/RI(1,n);   
if CR<0.10
    disp('CI=');disp(CI);
    disp('CR=');disp(CR);
    disp('对比矩阵A通过一致性检验，各向量权重向量Q为：');
    Q=zeros(n,1);
    for i=1:n
        Q(i,1)=C(i,1)/sum(C(:,1)); %特征向量标准化
    end
    Q                              %输出权重向量
else
    disp('对比矩阵A未通过一致性检验，需对对比矩阵A重新构造');
end
```

![1655251928040](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655251928040.png)



```matlab
A=[1 3 5;
1/3 1 2;
1/5 1/2 1]; %评价矩阵 
    
   A=[1 3 2;
   1/3 1 1/2;
   1/2 2 1]; %评价矩阵 
   
       
    A=[1 1/2 1/3;
    2 1 1;
    3 1 1]; %评价矩阵 
    
    A=[1 2 1;
    1/2 1 1;
    1 1 1]; %评价矩阵 
    
    A=[1 2 3;
    1/2 1 3;
    1/3 1/3 1]; %评价矩阵 
    
    A=[1 2 3;
    1/2 1 2;
    1/3 1/2 1]; %评价矩阵 

```

![1655253211887](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655253211887.png)

![1655253240040](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655253240040.png)

![1655253272205](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655253272205.png)



![1655253311644](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655253311644.png)

![1655253520251](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655253520251.png)

![1655253552142](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655253552142.png)



层次单排序、层次总排序，得到，权重组合表：

| w(2) | 0.0862 | 0.2566 | 0.1238 | 0.2566 | 0.1353 | 0.1415 |
| ---- | ------ | ------ | ------ | ------ | ------ | ------ |
|      | 0.6483 | 0.5396 | 0.1692 | 0.4126 | 0.5278 | 0.5396 |
| w(3) | 0.2297 | 0.1634 | 0.3874 | 0.2599 | 0.3325 | 0.2970 |
|      | 0.1220 | 0.2970 | 0.4434 | 0.3275 | 0.1396 | 0.1634 |
| CI   | 0.0018 | 0.0046 | 0.0091 | 0.0268 | 0.0268 | 0.0046 |
| CR   | 0.0032 | 0.0079 | 0.0158 | 0.0462 | 0.0462 | 0.0079 |

RI=0.58(n=3),CI 均可通过一致性检验。

方案层对目标的组和权向量为：

![1655255112660](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655255112660.png)

![1655255126682](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655255126682.png)

**因此，应选择P1工作单位。**

## （2）选择旅游目的地

![1655214077546](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655214077546.png)

方法同（1）



## （3）选择女朋友

![1655214106501](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655214106501.png)

方法思路同（1）



## （4）员工年终综合评定

![1655214510041](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655214510041.png)

![1655278703034](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655278703034.png)

![1655278725454](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655278725454.png)

![1655278907749](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655278907749.png)

```matlab
A=[1 1/5 1/4 5 5;5 1 2 5 5;4 1/2 1 5 5;1/5 1/5 1/5 1 1;1/5 1/5 1/5 1 1];

A=[1 1/3 1 2 5;3 1 3 5 5;1 1/3 1 2 5;1/2 1/5 1/2 1 5;1/5 1/5 1/5 1/5 1];

A=[1 1/3 1/2 5 5;3 1 2 5 5;2 1/2 1 5 5;1/5 1/5 1/5 1 1;1/5 1/5 1/5 1 1];

A=[1 1/3 1 5 5;3 1 3 5 5;1 1/3 1 5 5;1/5 1/5 1/5 1 1;1/5 1/5 1/5 1 1];
```





| w(2) | 0.25   | 0.2    | 0.25   | 0.3    |
| ---- | ------ | ------ | ------ | ------ |
| w(3) | 0.1552 | 0.1889 | 0.1997 | 0.2205 |
| w(3) | 0.4327 | 0.4586 | 0.4102 | 0.4477 |
| w(3) | 0.3075 | 0.1889 | 0.2783 | 0.2205 |
| w(3) | 0.0523 | 0.1187 | 0.0559 | 0.0556 |
| w(3) | 0.0523 | 0.0449 | 0.0559 | 0.0556 |
| CI   | 0.1059 | 0.0637 | 0.0449 | 0.0494 |
| CR   | 0.0945 | 0.0569 | 0.0401 | 0.0441 |

RI=1.12 (n=5), CIk 均可通过一致性检验。

得到的权重组合表：

![1655280926568](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655280926568.png)

因此，评语为：良好。



## （5）部门员工年终评定（多层次）

![1655214536212](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655214536212.png)

思路和（4）一样，只是多加了一层，先从底层算起，一直往上走，即“层次单排序”逐渐过渡到“层次总排序”。

最后即可得到结果。



# 二、模糊综合评价法解决

![1655426510439](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655426510439.png)

![1655426537286](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655426537286.png)

**我的解答：**

（1）相对偏差法

```matlab
B1=[0.8 0.2 0.5 0.1;0.15 0.6 0.4 0.3;0.05 0.1 0.1 0.5;0 0.1 0 0.05;0 0 0 0.05];

B2=[0.3 0.2 0.4 0.1 0.3;0.5 0.2 0.4 0.3 0.2;0.15 0.4 0.1 0.3 0.2;0.05 0.1 0.1 0.2 0.2;0 0.1 0 0.1 0.1];

B3=[0.1 0.2 0.2 0.1 0.1;0.3 0.3 0.3 0.3 0.4;0.5 0.3 0.35 0.4 0.3;0.1 0.1 0.15 0.1 0.1;0 0.1 0 0.1 0.1];

B4=[0.3 0.1 0.2 0.4;0.4 0.4 0.3 0.3;0.2 0.3 0.4 0.2;0.1 0.1 0.1 0.1;0 0.1 0 0];
```

算法模板（相对偏差;客观打分）

```matlab
R1=[0.3291;
    0.4086;
    0.6979;
    0.9612;
    1.0000
];

R2=[0.3847;
    0.1712;
    0.4651;
    0.7769;
    1.0000];

R3=[0.7663;
    0.2038;
    0.0655;
    0.8629;
    1.0000];

R4=[0.4223;
    0.1284;
    0.3333;
    0.8074;
    1.0000];
A=[R1 R2 R3 R4];
[m,n]=size(A);%找出多少行多少列
maxA=max(A);%找出每列最大值
minA=min(A);%找出每列最小值
G=maxA-min(A);%最大值减去最小值
A1=max(A(:,1:4));%A1为效益型
%A2=min(A(:,2:n-1));%A2~A6为成本型
%A3=max(A(:,7));%A7为效益型
u=[A1];
R=zeros(m,n);%将模糊综合矩阵初值设置为0
% 如下是得出模糊综合矩阵
for i=1:m
    for j=1:n
        R(i,j)=abs(A(i,j)-u(j))/G(j)
    end
end
%利用变异系数计算权向量
x=mean(A);
s=std(A);
v=s./x;
v2=sum(v);
c=zeros(1,4);
for i=1:4
    c(i)=v(i)/v2;
end

FF=R*c';FF%;%用来输出FF矩阵
```



```matlab
R1=[0.3291
    0.4086；
    0.6979；
    0.9612；
    1.0000
];

R2=[0.3847；
    0.1712；
    0.4651；
    0.7769；
    1.0000];

R3=[0.7663；
    0.2038；
    0.0655；
    0.8629；
    1.0000];

R4=[0.4223；
    0.1284；
    0.3333；
    0.8074；
    1.0000];
```



答案：

```matlab
0.6224
0.9339
0.7470
0.1801
0
```

因此，评价为：较差（明显不对劲）



（2）相对优属度法

算法模板：

```matlab
R1=[0.6883;
    0.6001;
    0.3021;
    0.0584;
    0.0196];

R2=[0.6940;
    0.8759;
    0.5521;
    0.3095;
    0.1281];

R3=[0.3551;
    0.8126;
    0.9509;
    0.2817;
    0.1446];

R4=[0.6352;
    0.8716;
    0.6858;
    0.2500;
    0.0574];
A=[R1 R2 R3 R4];
[m,n]=size(A);%找出多少行多少列
maxA=max(A);%找出每列最大值
minA=min(A);%找出每列最小值
R=zeros(m,n);%将模糊综合矩阵初值设置为0
% 如下是得出模糊综合矩阵
for i=1:m
    for j=1:n
	R(i,j)=A(i,j)/maxA(j)
	end
end
%利用变异系数计算权向量
x=mean(A);
s=std(A);
v=s./x;
v2=sum(v);
c=zeros(1,4);
for i=1:4
    c(i)=v(i)/v2;
end

FF=R*c';FF%;
```



```matlab
B1=[0.8 0.2 0.5 0.1;0.15 0.6 0.4 0.3;0.05 0.1 0.1 0.5;0 0.1 0 0.05;0 0 0 0.05];

B2=[0.3 0.2 0.4 0.1 0.3;0.5 0.2 0.4 0.3 0.2;0.15 0.4 0.1 0.3 0.2;0.05 0.1 0.1 0.2 0.2;0 0.1 0 0.1 0.1];

B3=[0.1 0.2 0.2 0.1 0.1;0.3 0.3 0.3 0.3 0.4;0.5 0.3 0.35 0.4 0.3;0.1 0.1 0.15 0.1 0.1;0 0.1 0 0.1 0.1];

B4=[0.3 0.1 0.2 0.4;0.4 0.4 0.3 0.3;0.2 0.3 0.4 0.2;0.1 0.1 0.1 0.1;0 0.1 0 0];
```



```matlab
R1=[0.6883;
    0.6001;
    0.3021;
    0.0584;
    0.0196];

R2=[0.6940;
    0.8759;
    0.5521;
    0.3095;
    0.1281];

R3=[0.3551;
    0.8126;
    0.9509;
    0.2817;
    0.1446];

R4=[0.6352;
    0.8716;
    0.6858;
    0.2500;
    0.0574];
```

结果：

```matlab
	0.7425
    0.9238
    0.6953
    0.2381
    0.0911
```



因此，结果为：良好。



**教材答案：**

![1655433952288](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655433952288.png)

![1655434253355](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1655434253355.png)

